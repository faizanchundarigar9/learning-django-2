{% extends 'base.html' %}

{% block content %}

<h1>Products in Your Cart</h1>

<div class="container">
  <div class="row">
    {% for cart_product in cart_products %}
    <div class="col">
        <div class="card product">
          <div class="card-body">
              <div class="row gy-3">
                  <div class="col-sm-auto">
                      <div class="avatar-lg bg-light rounded p-1">
                          <img src="{{ cart_product.product.image.url }}" alt="" class="img-fluid d-block">
                      </div>
                  </div>
                  <div class="col-sm">
                      <h5 class="fs-14 text-truncate"><a href="#" class="text-body">{{ cart_product.product }}</a></h5>

                      <form method="POST" action="{% url 'viewcart' %}">
                        {% csrf_token %}
                        <div class="input-step">
                            <button type="submit" class="minus" name="product_id" value="{{ cart_product.product.id }}" name="quantity" value="{{ cart_product.quantity|add:-1 }}">-</button>
                            <input type="number" name="quantity" class="product-quantity" value="{{ cart_product.quantity }}" min="1" max="100">
                            <button type="submit" class="plus" name="product_id" value="{{ cart_product.product.id }}" name="quantity" value="{{ cart_product.quantity|add:1 }}">+</button>
                        </div>
                      </form>
                  </div>
                  <div class="col-sm-auto">
                      <div class="text-lg-end">
                          <p class="text-muted mb-1">Item Price:</p>
                          <h5 class="fs-14">₹<span class="product-price"> {{ cart_product.product.price }}</span></h5>
                      </div>
                  </div>
              </div>
          </div>
          <!-- card body -->
          <div class="card-footer">
              <div class="row align-items-center gy-3">
                  <div class="col-sm">
                      <div class="d-flex flex-wrap my-n1">
                          <div>
                            <form action="{% url 'removefromcart' cart_product.product.id %}" method="post">
                              {% csrf_token %}
                              <button type="submit">Remove</button>
                            </form>
                          </div>
                          <div>
                              <a href="#" class="d-block text-body p-1 px-2"><i class="ri-star-fill text-muted align-bottom me-1"></i> Add
                                  Wishlist</a>
                          </div>
                      </div>
                  </div>
                  <div class="col-sm-auto">
                      <div class="d-flex align-items-center gap-2 text-muted">
                          <div>Total :</div>
                          <h5 class="fs-14 mb-0">₹<span class="product-line-price">{{ cart_product.product.price }}</span></h5>
                      </div>
                  </div>
              </div>
          </div>
        <!-- end card footer -->
      </div>
    </div>
    {% empty %}
    <li>No products in your cart.</li>
    {% endfor %}
    <section>
        <form action='{% url "checkout" %}'>
            <button class="bg-light">
                Checkout
            </button>
        </form>
    </section>
    <section>
        <h3> Total = ₹{{ cart.total }} </h3>
    </section>
  </div>
</div>

{% endblock content %}


